# 第1章：从需求到项目 - 需求分析思维

> **本章目标**：学会将模糊的想法转化为清晰的项目需求，这是项目成败的第一步

---

## 🎯 核心概念

### 什么是需求分析？

想象你要盖一栋房子：
- ❌ **错误做法**：直接开始搬砖砌墙
- ✅ **正确做法**：先问清楚要几个房间、多大面积、什么风格、预算多少

**需求分析就是在写代码之前，先搞清楚要做什么的过程。**

### 为什么需求分析如此重要？

```
没有需求分析的项目 = 没有地图的旅行
↓
边走边改方向
↓
浪费时间 + 返工 + 最终做出没人用的东西
```

**数据说话**：
- 70% 的项目失败源于需求不清晰
- 在需求阶段发现问题，成本是 1
- 在开发阶段发现问题，成本是 10
- 在上线后发现问题，成本是 100

---

## 🧠 思维方法

### 方法一：5W1H 提问法

对任何项目想法，问自己这 6 个问题：

| 问题 | 英文 | 说明 | 示例 |
|------|------|------|------|
| **为什么做** | Why | 解决什么问题 | 手动交易太累，想自动化 |
| **做什么** | What | 核心功能是什么 | AI 自动分析市场并交易 |
| **给谁用** | Who | 目标用户是谁 | 加密货币交易者 |
| **在哪用** | Where | 使用场景 | 7x24 小时自动运行 |
| **什么时候用** | When | 触发时机 | 每 3 分钟分析一次 |
| **怎么做** | How | 技术方案（暂不深入） | 后端 AI + 前端监控 |

### 方法二：核心需求 vs 次要需求

把所有想法分成 3 类：

```
🔴 核心需求（Must Have）- 没有这个，项目就没意义
   ↓
🟡 重要需求（Should Have）- 有了更好，但不是必须
   ↓
🟢 锦上添花（Nice to Have）- 可以以后再加
```

**判断标准**：
- 核心需求：去掉它，用户会说"这不能用"
- 重要需求：去掉它，用户会说"不太方便"
- 锦上添花：去掉它，用户会说"无所谓"

### 方法三：用户故事法

用一句话描述功能：

```
作为【角色】，我想要【功能】，以便【价值】
```

**好的用户故事示例**：
- ✅ "作为交易者，我想要 AI 自动开仓，以便我不用 24 小时盯盘"
- ✅ "作为交易者，我想要看到实时盈亏曲线，以便评估 AI 表现"
- ❌ "系统需要一个数据库"（这是技术实现，不是用户需求）

### 方法四：边界划定法

明确**做什么**和**不做什么**：

| ✅ 做 | ❌ 不做 | 原因 |
|------|---------|------|
| 期货自动交易 | 现货交易 | 聚焦一个市场 |
| 支持 3 个主流交易所 | 支持所有交易所 | MVP 阶段控制复杂度 |
| Web 监控界面 | 移动 APP | 先验证核心功能 |
| AI 决策 | 手动下单 | 自动化是核心价值 |

---

## 📚 NOFX 案例分析

### 背景：NOFX 的诞生过程

假设我们是 NOFX 的创始人，最初的想法很模糊：

```
💭 初始想法：
"我想做一个 AI 自动交易的系统，帮我赚钱"
```

这个想法太模糊了！我们来用上面的方法分析。

---

### 第一步：5W1H 分析

#### 1. Why - 为什么做？

**痛点分析**：
- 😫 人工交易需要 24 小时盯盘，太累
- 😫 情绪化决策，涨了贪婪，跌了恐惧
- 😫 错过最佳入场时机
- 😫 想尝试多个策略，但精力有限
- 😫 想知道哪个 AI 模型更强，但无法对比

**核心问题**：
> 能否让 AI 代替我做交易决策，并且能比较不同 AI 的表现？

#### 2. What - 做什么？

**核心功能**：
1. AI 自动分析市场数据（价格、指标、持仓量）
2. AI 自主决策开仓/平仓（币种、方向、杠杆、止损止盈）
3. 自动执行交易（对接交易所 API）
4. 记录每次决策和结果（日志系统）
5. 可视化展示（账户、持仓、盈亏曲线）
6. 多 AI 竞赛（对比不同模型表现）

#### 3. Who - 给谁用？

**用户画像**：
- 有一定交易经验的加密货币交易者
- 了解期货、杠杆、止损止盈等概念
- 希望尝试 AI 自动交易，但不是专业开发者
- 有小额资金用于测试（100-1000 USDT）
- 对 AI 技术感兴趣，想对比不同模型

#### 4. Where - 在哪用？

**使用场景**：
- 服务器 7x24 小时运行（VPS/云服务器）
- 通过浏览器查看监控界面
- 支持 Docker 一键部署（降低门槛）

#### 5. When - 什么时候用？

**时机设计**：
- 每 3-5 分钟自动分析一次市场
- 有机会就开仓，触发止损/止盈就平仓
- 用户随时可以查看实时状态
- 系统记录所有决策历史

#### 6. How - 怎么做？

**技术选型**（初步构思）：
- 后端：Go（高性能、并发友好）
- 前端：React（组件化、生态丰富）
- AI API：DeepSeek/Qwen（成本低、效果好）
- 交易所：Binance/Hyperliquid/Aster（主流平台）

---

### 第二步：需求优先级划分

根据 MoSCoW 方法（Must/Should/Could/Won't），我们划分需求：

#### 🔴 核心需求（Must Have）- MVP 必须有

1. **配置系统**
   - 用户能配置 API Key
   - 能选择交易所和 AI 模型
   - 能设置初始余额和扫描间隔

2. **数据获取**
   - 获取账户余额和持仓
   - 获取 K 线数据（3分钟 + 4小时）
   - 计算技术指标（EMA、MACD、RSI）

3. **AI 决策引擎**
   - 构建提示词（市场数据 + 账户状态）
   - 调用 AI API 获取决策
   - 解析 JSON 响应

4. **交易执行**
   - 开多/开空
   - 平多/平空
   - 设置止损止盈

5. **基础前端**
   - 显示账户余额
   - 显示当前持仓
   - 显示最近决策日志

#### 🟡 重要需求（Should Have）- 第二版加入

6. **风险控制**
   - 仓位大小限制
   - 保证金使用率控制
   - 每日亏损限制

7. **性能追踪**
   - 记录每笔交易盈亏
   - 计算胜率、盈亏比
   - 生成权益曲线图

8. **多交易所支持**
   - Binance
   - Hyperliquid
   - Aster DEX

#### 🟢 锦上添花（Nice to Have）- 未来扩展

9. **多 AI 竞赛**
   - 同时运行多个 AI
   - 对比图表
   - 排行榜

10. **AI 自学习**
    - 历史表现反馈
    - 避免重复错误
    - 强化成功策略

11. **高级功能**
    - 回测系统
    - 策略优化
    - 风险预警

---

### 第三步：编写用户故事

基于上面的分析，我们写出清晰的用户故事：

#### 用户故事 1：配置交易账户
```
作为交易者，
我想要配置我的 Binance API Key 和 DeepSeek API Key，
以便系统能代表我进行交易。

验收标准：
✅ 能通过 config.json 配置所有必要参数
✅ 配置错误时给出清晰提示
✅ 支持多个交易者配置
```

#### 用户故事 2：自动交易决策
```
作为交易者，
我想要 AI 每 3 分钟自动分析市场并决策，
以便不用人工盯盘。

验收标准：
✅ 系统自动运行，无需人工干预
✅ AI 能看到完整市场数据和账户状态
✅ AI 返回结构化决策（币种、方向、杠杆、止损止盈）
```

#### 用户故事 3：查看实时状态
```
作为交易者，
我想要通过网页查看账户余额、持仓和盈亏，
以便了解 AI 的表现。

验收标准：
✅ 打开浏览器即可查看
✅ 数据每 5-10 秒自动刷新
✅ 能看到历史决策日志
```

#### 用户故事 4：风险保护
```
作为交易者，
我想要系统限制单笔仓位大小，
以便避免爆仓风险。

验收标准：
✅ 山寨币仓位 ≤ 账户权益 1.5 倍
✅ BTC/ETH 仓位 ≤ 账户权益 10 倍
✅ 总保证金使用率 ≤ 90%
```

#### 用户故事 5：性能评估
```
作为交易者，
我想要看到历史盈亏曲线和胜率统计，
以便评估 AI 策略是否有效。

验收标准：
✅ 能看到权益曲线图（按时间）
✅ 能看到胜率、盈亏比、夏普比率
✅ 能看到每个币种的表现统计
```

---

### 第四步：边界划定

明确 NOFX **做什么**和**不做什么**：

| 维度 | ✅ 做 | ❌ 不做 | 原因 |
|------|-------|---------|------|
| **交易类型** | 期货（永续合约） | 现货、期权 | 聚焦高频自动化场景 |
| **交易所数量** | 3 个主流平台 | 所有交易所 | 验证可扩展性即可 |
| **AI 模型** | DeepSeek、Qwen | 训练自己的模型 | 利用现成 API 降低门槛 |
| **决策方式** | AI 全权决策 | 人工确认每笔交易 | 自动化是核心价值 |
| **界面** | Web 监控界面 | 移动 APP、桌面软件 | MVP 阶段简化 |
| **部署** | Docker 一键部署 | 复杂的分布式部署 | 降低用户门槛 |
| **数据分析** | 实时监控 | 深度回测、策略优化 | 先验证核心功能 |
| **用户管理** | 单用户（自己用） | 多租户 SaaS 平台 | 初期不做商业化 |

---

### 第五步：功能清单（Feature List）

最终整理出 NOFX 的完整功能清单：

#### 📦 MVP 版本（v1.0）

**后端核心**：
- [ ] 配置文件加载（config.json）
- [ ] Binance API 集成（账户、行情、交易）
- [ ] 技术指标计算（TA-Lib）
- [ ] AI API 调用（DeepSeek）
- [ ] 决策引擎（提示词构建 + JSON 解析）
- [ ] 交易执行（开仓、平仓、止损止盈）
- [ ] 日志记录（JSON 文件）

**前端基础**：
- [ ] 账户信息展示
- [ ] 持仓列表
- [ ] 决策日志列表
- [ ] 简单样式（能看清即可）

**部署**：
- [ ] Go 编译运行
- [ ] npm 本地开发
- [ ] README 使用说明

#### 📦 增强版本（v2.0）

**后端增强**：
- [ ] 多交易所支持（Hyperliquid、Aster）
- [ ] 多 AI 模型支持（Qwen）
- [ ] 性能追踪系统（胜率、盈亏比）
- [ ] AI 自学习（历史反馈）
- [ ] 风险控制优化

**前端优化**：
- [ ] 权益曲线图表
- [ ] 多 AI 对比图表
- [ ] 竞赛排行榜
- [ ] Binance 风格 UI

**部署优化**：
- [ ] Docker 一键部署
- [ ] docker-compose 多容器编排
- [ ] 启动脚本（start.sh）

#### 📦 未来扩展（v3.0+）

- [ ] 回测系统
- [ ] 策略编辑器
- [ ] 风险预警通知
- [ ] 移动端适配
- [ ] 社区策略分享

---

## 🎯 NOFX 需求分析总结

### 核心价值主张

```
NOFX = AI 自动交易 + 多模型竞赛 + 可视化监控

让普通交易者用上 AI 自动交易，
并能对比不同 AI 模型的实战表现。
```

### 关键设计决策

| 决策点 | 选择 | 原因 |
|--------|------|------|
| **自动化程度** | AI 全权决策 | 核心价值是解放人工 |
| **灵活性** | 多交易所、多 AI | 可扩展性验证 |
| **门槛** | Docker 一键部署 | 降低技术门槛 |
| **透明度** | 完整日志 + 可视化 | 建立信任 |
| **风险** | 内置风控规则 | 保护用户资金 |

### MVP 范围界定

**第一版只做**：
1. 单交易所（Binance）
2. 单 AI 模型（DeepSeek）
3. 基础监控界面
4. 基本风控

**快速验证**：
- AI 能否做出合理决策？
- 系统能否稳定运行？
- 用户体验是否流畅？

**如果 MVP 成功** → 再添加多交易所、多 AI、高级功能

---

## 💪 实战练习

### 练习 1：分析你的项目想法（必做）

拿出你想做的项目，回答以下问题：

```markdown
## 我的项目需求分析

### 1. 5W1H 分析
- **Why（为什么做）**：我要解决什么问题？
- **What（做什么）**：核心功能是什么？
- **Who（给谁用）**：目标用户是谁？
- **Where（在哪用）**：使用场景？
- **When（什么时候用）**：触发时机？
- **How（怎么做）**：初步技术方案？

### 2. 需求优先级
列出 10 个功能想法，分成：
- 🔴 核心需求（3-5 个）：
- 🟡 重要需求（3-5 个）：
- 🟢 锦上添花（2-3 个）：

### 3. 用户故事
为核心需求写 3 个用户故事：
- 用户故事 1：
- 用户故事 2：
- 用户故事 3：

### 4. 边界划定
列出"做什么"和"不做什么"：
- ✅ 做：
- ❌ 不做（原因）：

### 5. MVP 范围
第一版只做哪 3-5 个核心功能？
```

**提示**：
- 诚实面对"做不做得出来"
- 从最小可验证版本开始
- 功能宁少勿多

---

### 练习 2：需求评审（选做）

找一个朋友，讲述你的项目需求，问他：

1. 你听懂我要做什么了吗？
2. 你觉得哪个功能最重要？
3. 你会用这个产品吗？为什么？
4. 你觉得还缺什么功能？

**记录反馈**：
- 他们听懂的部分：
- 他们困惑的部分：
- 他们的建议：
- 我的调整：

---

### 练习 3：竞品分析（选做）

找 2-3 个类似的项目，分析：

| 项目名 | 核心功能 | 优点 | 缺点 | 我能学到什么 |
|--------|----------|------|------|--------------|
| 竞品 1 |          |      |      |              |
| 竞品 2 |          |      |      |              |
| 竞品 3 |          |      |      |              |

**思考**：
- 我的项目和他们有什么不同？
- 我能做得更好的点在哪里？

---

## 🤔 思考题

1. **为什么 NOFX 选择"AI 全权决策"而不是"AI 建议 + 人工确认"？**
   <details>
   <summary>点击查看答案</summary>

   因为：
   - 核心价值是"自动化"，人工确认违背初衷
   - 人工确认会引入情绪化决策，反而不如 AI 理性
   - 7x24 小时运行，人工确认不现实
   - 但系统提供完整日志，用户可以随时停止
   </details>

2. **为什么 MVP 不包括"回测系统"？**
   <details>
   <summary>点击查看答案</summary>

   因为：
   - 回测是"验证策略"，实盘是"验证系统"
   - MVP 的目标是验证核心流程能否跑通
   - 回测系统开发成本高，且不是核心价值
   - 可以先用实盘小金额测试，积累数据后再做回测
   </details>

3. **如果用户说"我还想支持股票交易"，你会怎么回应？**
   <details>
   <summary>点击查看答案</summary>

   回应：
   - "感谢建议！这是个好方向"
   - "但我们先聚焦在加密货币期货，原因是："
     - 7x24 交易，更适合自动化
     - API 开放，技术实现更简单
     - 验证 AI 决策能力即可，股票逻辑类似
   - "等系统稳定后，股票可以作为第二个市场扩展"

   核心思路：**聚焦 MVP，延后扩展**
   </details>

---

## 📖 本章总结

### 你学到了什么

✅ **思维方法**：
- 5W1H 提问法：全面分析项目
- 需求优先级：区分核心、重要、锦上添花
- 用户故事：用户视角描述功能
- 边界划定：明确做什么、不做什么

✅ **实践技能**：
- 能将模糊想法转化为清晰需求清单
- 能识别哪些功能是 MVP 必须的
- 能写出清晰的用户故事
- 能制定合理的项目边界

✅ **案例收获**：
- NOFX 的需求是如何从"想法"变成"功能清单"的
- 为什么选择这些功能，不选择那些功能
- MVP 如何快速验证核心价值

### 下一步

完成练习后，你应该有：
- ✅ 一份你的项目需求分析文档
- ✅ 明确的 MVP 功能清单（3-5 个核心功能）
- ✅ 清晰的用户故事（至少 3 个）

准备好后，进入 **第 2 章：项目整体架构设计**，学习如何将需求转化为技术架构！

---

## 📚 延伸阅读

- 《用户故事地图》- Jeff Patton
- 《精益创业》- Eric Ries（MVP 思想来源）
- 《需求工程：软件建模与分析》
- NOFX README.md 的演进历史（查看 Git 提交记录）

---

## ❓ FAQ

**Q1：需求分析要多详细？**
A：刚开始可以粗糙，关键是**搞清楚核心价值**。详细需求在开发过程中逐步完善。

**Q2：需求变化怎么办？**
A：正常现象！但**核心需求不应频繁变**。次要需求可以灵活调整。

**Q3：我不知道技术上能不能实现，怎么办？**
A：需求阶段先不考虑技术细节。列出理想功能，技术调研在架构阶段做。

**Q4：用户故事和功能列表有什么区别？**
A：
- 用户故事：从**用户视角**描述价值（为什么要这个功能）
- 功能列表：从**开发视角**描述实现（这个功能包含什么）

两者互补，都需要。

---

**🎉 恭喜完成第 1 章！**

现在你已经掌握了项目构建的第一步：**需求分析**。

记住：**好的开始是成功的一半，清晰的需求是成功的一半。**

准备好了吗？让我们进入第 2 章！💪
