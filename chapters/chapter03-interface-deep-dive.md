# ç¬¬3ç« è¡¥å……ï¼šæ¥å£å’ŒæŠ½è±¡åŸºç±»æ·±åº¦è§£æ

> **æœ¬æ–‡ç›®æ ‡**ï¼šå½»åº•ç†è§£æ¥å£å’ŒæŠ½è±¡åŸºç±»ï¼ŒçŸ¥é“ä¸ºä»€ä¹ˆç”¨ã€æ€ä¹ˆç”¨

---

## ğŸ“‹ æœ¬æ–‡å¤§çº²

1. [ä»ç”Ÿæ´»ä¾‹å­å¼€å§‹](#1-ä»ç”Ÿæ´»ä¾‹å­å¼€å§‹)
2. [æ™®é€šç±» vs æŠ½è±¡ç±» vs æ¥å£](#2-æ™®é€šç±»-vs-æŠ½è±¡ç±»-vs-æ¥å£)
3. [æŠ½è±¡åŸºç±»ABCçš„ä½œç”¨](#3-æŠ½è±¡åŸºç±»abcçš„ä½œç”¨)
4. [ä¸€æ­¥æ­¥å­¦ä¼šä½¿ç”¨ABC](#4-ä¸€æ­¥æ­¥å­¦ä¼šä½¿ç”¨abc)
5. [å¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ](#5-å¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ)
6. [å®æˆ˜æ¡ˆä¾‹](#6-å®æˆ˜æ¡ˆä¾‹)
7. [æ€»ç»“å’Œæœ€ä½³å®è·µ](#7-æ€»ç»“å’Œæœ€ä½³å®è·µ)

**é¢„è®¡å­¦ä¹ æ—¶é—´**ï¼š30-40åˆ†é’Ÿ

---

## 1. ä»ç”Ÿæ´»ä¾‹å­å¼€å§‹

### 1.1 ç”Ÿæ´»ä¸­çš„"è§„èŒƒ"

æƒ³è±¡ä½ æ˜¯ä¸€ä¸ªé¤å…è€æ¿ï¼Œè¦æ‹›è˜å¨å¸ˆã€‚

**åœºæ™¯1ï¼šæ²¡æœ‰è§„èŒƒï¼ˆç³Ÿç³•ï¼‰**

```
ä½ ï¼šæˆ‘æ‹›3ä¸ªå¨å¸ˆ
å¨å¸ˆAï¼šæˆ‘åªä¼šåšé¥­
å¨å¸ˆBï¼šæˆ‘åªä¼šåˆ‡èœ
å¨å¸ˆCï¼šæˆ‘åªä¼šæ´—ç¢—

ä½ æƒ³è®©ä»–ä»¬åšèœæ—¶ï¼š
ä½ å¯¹Aè¯´ï¼šåšä¸€ä»½å®«ä¿é¸¡ä¸
ä½ å¯¹Bè¯´ï¼šåšä¸€ä»½å®«ä¿é¸¡ä¸ âŒ Bè¯´ï¼šæˆ‘ä¸ä¼šåšï¼Œæˆ‘åªä¼šåˆ‡èœ
ä½ å¯¹Cè¯´ï¼šåšä¸€ä»½å®«ä¿é¸¡ä¸ âŒ Cè¯´ï¼šæˆ‘ä¸ä¼šåšï¼Œæˆ‘åªä¼šæ´—ç¢—

é—®é¢˜ï¼šä½ ä¸çŸ¥é“è°èƒ½åšä»€ä¹ˆï¼Œæ¯æ¬¡éƒ½è¦è¯•
```

**åœºæ™¯2ï¼šæœ‰è§„èŒƒï¼ˆå¥½ï¼‰**

```
ä½ ï¼šæˆ‘è¦æ‹›è˜"å¨å¸ˆ"ï¼Œå¨å¸ˆå¿…é¡»ä¼šï¼š
1. åšèœï¼ˆå¿…é¡»ä¼šï¼‰
2. åˆ‡èœï¼ˆå¿…é¡»ä¼šï¼‰
3. æ´—ç¢—ï¼ˆå¿…é¡»ä¼šï¼‰

ç°åœ¨æ‹›è˜ï¼š
å¨å¸ˆAï¼šæˆ‘ä¼šåšèœã€åˆ‡èœã€æ´—ç¢— âœ… å½•ç”¨
å¨å¸ˆBï¼šæˆ‘åªä¼šåˆ‡èœ âŒ ä¸ç¬¦åˆ"å¨å¸ˆ"è§„èŒƒï¼Œä¸å½•ç”¨
å¨å¸ˆCï¼šæˆ‘ä¼šåšèœã€åˆ‡èœï¼Œä½†ä¸ä¼šæ´—ç¢— âŒ ä¸ç¬¦åˆè§„èŒƒï¼Œä¸å½•ç”¨

ç°åœ¨ä½ å¯ä»¥æ”¾å¿ƒäº†ï¼š
æ‰€æœ‰è¢«å½•ç”¨çš„"å¨å¸ˆ"ï¼Œéƒ½èƒ½åšèœã€åˆ‡èœã€æ´—ç¢—
ä½ è®©ä»»ä½•ä¸€ä¸ªå¨å¸ˆåšèœï¼Œä»–ä»¬éƒ½èƒ½åš
```

**è¿™ä¸ªè§„èŒƒï¼Œå°±æ˜¯"æ¥å£"ï¼**

---

## 2. æ™®é€šç±» vs æŠ½è±¡ç±» vs æ¥å£

### 2.1 æ™®é€šç±»ï¼ˆå…·ä½“çš„å®ç°ï¼‰

```python
class å·èœå¨å¸ˆ:
    def åšèœ(self):
        print("åšä¸€ä»½å®«ä¿é¸¡ä¸")

    def åˆ‡èœ(self):
        print("åˆ‡æˆä¸")

    def æ´—ç¢—(self):
        print("æ´—ç¢—ä¸­...")

# å¯ä»¥ç›´æ¥ä½¿ç”¨
å¨å¸ˆ = å·èœå¨å¸ˆ()
å¨å¸ˆ.åšèœ()  # åšä¸€ä»½å®«ä¿é¸¡ä¸
```

**ç‰¹ç‚¹**ï¼š
- âœ… æ‰€æœ‰æ–¹æ³•éƒ½æœ‰å…·ä½“å®ç°
- âœ… å¯ä»¥ç›´æ¥åˆ›å»ºå¯¹è±¡ä½¿ç”¨
- âŒ æ²¡æœ‰å¼ºåˆ¶è¦æ±‚å­ç±»å¿…é¡»å®ç°ä»€ä¹ˆ

### 2.2 æŠ½è±¡ç±»ï¼ˆè§„èŒƒ + éƒ¨åˆ†å®ç°ï¼‰

```python
from abc import ABC, abstractmethod

class å¨å¸ˆ(ABC):  # ç»§æ‰¿ABCï¼Œè¿™æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»
    """å¨å¸ˆçš„è§„èŒƒï¼šæ‰€æœ‰å¨å¸ˆå¿…é¡»ä¼šåšèœ"""

    @abstractmethod  # è¿™æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œå¿…é¡»å®ç°
    def åšèœ(self):
        """å­ç±»å¿…é¡»å®ç°è¿™ä¸ªæ–¹æ³•"""
        pass

    # è¿™æ˜¯æ™®é€šæ–¹æ³•ï¼Œå·²ç»æœ‰å®ç°
    def æ´—ç¢—(self):
        print("æ´—ç¢—ä¸­...")

# âŒ ä¸èƒ½ç›´æ¥åˆ›å»ºæŠ½è±¡ç±»çš„å¯¹è±¡
# å¨å¸ˆå¯¹è±¡ = å¨å¸ˆ()  # æŠ¥é”™ï¼TypeError: Can't instantiate abstract class

# âœ… å¿…é¡»åˆ›å»ºå­ç±»ï¼Œå¹¶å®ç°æŠ½è±¡æ–¹æ³•
class å·èœå¨å¸ˆ(å¨å¸ˆ):
    def åšèœ(self):  # å®ç°äº†æŠ½è±¡æ–¹æ³•
        print("åšå®«ä¿é¸¡ä¸")

å¨å¸ˆ = å·èœå¨å¸ˆ()
å¨å¸ˆ.åšèœ()  # åšå®«ä¿é¸¡ä¸
å¨å¸ˆ.æ´—ç¢—()  # æ´—ç¢—ä¸­...ï¼ˆç»§æ‰¿è‡ªçˆ¶ç±»ï¼‰
```

**ç‰¹ç‚¹**ï¼š
- âœ… å®šä¹‰äº†è§„èŒƒï¼ˆæŠ½è±¡æ–¹æ³•ï¼‰
- âœ… å¯ä»¥æœ‰éƒ¨åˆ†å®ç°ï¼ˆæ™®é€šæ–¹æ³•ï¼‰
- âœ… å¼ºåˆ¶å­ç±»å¿…é¡»å®ç°æŠ½è±¡æ–¹æ³•
- âŒ ä¸èƒ½ç›´æ¥åˆ›å»ºå¯¹è±¡

### 2.3 æ¥å£ï¼ˆçº¯è§„èŒƒï¼‰

```python
from abc import ABC, abstractmethod

class å¨å¸ˆæ¥å£(ABC):
    """çº¯è§„èŒƒï¼šåªå®šä¹‰å¿…é¡»åšä»€ä¹ˆï¼Œä¸æä¾›ä»»ä½•å®ç°"""

    @abstractmethod
    def åšèœ(self):
        pass

    @abstractmethod
    def åˆ‡èœ(self):
        pass

    @abstractmethod
    def æ´—ç¢—(self):
        pass

# å®ç°æ¥å£
class å·èœå¨å¸ˆ(å¨å¸ˆæ¥å£):
    def åšèœ(self):
        print("åšå®«ä¿é¸¡ä¸")

    def åˆ‡èœ(self):
        print("åˆ‡ä¸")

    def æ´—ç¢—(self):
        print("æ´—ç¢—")

# ä½¿ç”¨
å¨å¸ˆ = å·èœå¨å¸ˆ()
å¨å¸ˆ.åšèœ()
```

**ç‰¹ç‚¹**ï¼š
- âœ… åªå®šä¹‰è§„èŒƒï¼Œä¸æä¾›å®ç°
- âœ… æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯æŠ½è±¡æ–¹æ³•
- âœ… å¼ºåˆ¶å®ç°æ‰€æœ‰æ–¹æ³•
- âŒ ä¸èƒ½ç›´æ¥åˆ›å»ºå¯¹è±¡

---

## 3. æŠ½è±¡åŸºç±»ABCçš„ä½œç”¨

### 3.1 ä½œç”¨1ï¼šå¼ºåˆ¶è§„èŒƒ

**æ²¡æœ‰ABCï¼ˆä¸å®‰å…¨ï¼‰**ï¼š

```python
class æ”¯ä»˜æ–¹å¼:
    pass

class æ”¯ä»˜å®æ”¯ä»˜(æ”¯ä»˜æ–¹å¼):
    def pay(self, amount):
        print(f"æ”¯ä»˜å®æ”¯ä»˜ {amount} å…ƒ")

class å¾®ä¿¡æ”¯ä»˜(æ”¯ä»˜æ–¹å¼):
    # å¿˜è®°å®ç° pay æ–¹æ³•äº†ï¼
    pass

# é—®é¢˜ï¼šè¿è¡Œæ—¶æ‰å‘ç°é”™è¯¯
def ç»“è´¦(æ”¯ä»˜æ–¹å¼, é‡‘é¢):
    æ”¯ä»˜æ–¹å¼.pay(é‡‘é¢)  # å¦‚æœæ˜¯å¾®ä¿¡æ”¯ä»˜ï¼Œè¿™é‡Œä¼šæŠ¥é”™ï¼

å¾®ä¿¡ = å¾®ä¿¡æ”¯ä»˜()
ç»“è´¦(å¾®ä¿¡, 100)  # âŒ è¿è¡Œæ—¶æ‰æŠ¥é”™ï¼šAttributeError: 'å¾®ä¿¡æ”¯ä»˜' object has no attribute 'pay'
```

**ä½¿ç”¨ABCï¼ˆå®‰å…¨ï¼‰**ï¼š

```python
from abc import ABC, abstractmethod

class æ”¯ä»˜æ–¹å¼(ABC):
    @abstractmethod
    def pay(self, amount):
        """æ‰€æœ‰æ”¯ä»˜æ–¹å¼å¿…é¡»å®ç°è¿™ä¸ªæ–¹æ³•"""
        pass

class æ”¯ä»˜å®æ”¯ä»˜(æ”¯ä»˜æ–¹å¼):
    def pay(self, amount):
        print(f"æ”¯ä»˜å®æ”¯ä»˜ {amount} å…ƒ")

# âŒ è¿™æ®µä»£ç æ ¹æœ¬è¿è¡Œä¸äº†ï¼Œåˆ›å»ºå¯¹è±¡æ—¶å°±æŠ¥é”™
class å¾®ä¿¡æ”¯ä»˜(æ”¯ä»˜æ–¹å¼):
    pass  # æ²¡æœ‰å®ç° pay æ–¹æ³•

å¾®ä¿¡ = å¾®ä¿¡æ”¯ä»˜()  # âŒ ç«‹å³æŠ¥é”™ï¼šTypeError: Can't instantiate abstract class å¾®ä¿¡æ”¯ä»˜ with abstract method pay
```

**å¥½å¤„**ï¼š
- âœ… å†™ä»£ç æ—¶å°±å‘ç°é”™è¯¯ï¼Œè€Œä¸æ˜¯è¿è¡Œæ—¶
- âœ… ä¿è¯æ‰€æœ‰å­ç±»éƒ½å®ç°äº†å¿…éœ€çš„æ–¹æ³•
- âœ… å›¢é˜Ÿåä½œæ—¶ï¼Œå¤§å®¶çŸ¥é“å¿…é¡»å®ç°ä»€ä¹ˆ

### 3.2 ä½œç”¨2ï¼šç»Ÿä¸€æ¥å£

**åœºæ™¯**ï¼šå¼€å‘ä¸€ä¸ªæ”¯ä»˜ç³»ç»Ÿï¼Œæ”¯æŒå¤šç§æ”¯ä»˜æ–¹å¼

```python
from abc import ABC, abstractmethod

# å®šä¹‰æ”¯ä»˜æ¥å£
class PaymentMethod(ABC):
    @abstractmethod
    def pay(self, amount):
        """æ”¯ä»˜æŒ‡å®šé‡‘é¢"""
        pass

    @abstractmethod
    def refund(self, amount):
        """é€€æ¬¾æŒ‡å®šé‡‘é¢"""
        pass

# å®ç°ï¼šæ”¯ä»˜å®
class AlipayPayment(PaymentMethod):
    def pay(self, amount):
        print(f"æ”¯ä»˜å®æ”¯ä»˜ {amount} å…ƒ")
        return True

    def refund(self, amount):
        print(f"æ”¯ä»˜å®é€€æ¬¾ {amount} å…ƒ")
        return True

# å®ç°ï¼šå¾®ä¿¡æ”¯ä»˜
class WechatPayment(PaymentMethod):
    def pay(self, amount):
        print(f"å¾®ä¿¡æ”¯ä»˜ {amount} å…ƒ")
        return True

    def refund(self, amount):
        print(f"å¾®ä¿¡é€€æ¬¾ {amount} å…ƒ")
        return True

# å®ç°ï¼šé“¶è¡Œå¡
class BankCardPayment(PaymentMethod):
    def pay(self, amount):
        print(f"é“¶è¡Œå¡æ”¯ä»˜ {amount} å…ƒ")
        return True

    def refund(self, amount):
        print(f"é“¶è¡Œå¡é€€æ¬¾ {amount} å…ƒ")
        return True

# ä½¿ç”¨ï¼šç»Ÿä¸€çš„å¤„ç†æ–¹å¼
def å¤„ç†è®¢å•æ”¯ä»˜(payment_method: PaymentMethod, amount: float):
    """
    è¿™ä¸ªå‡½æ•°ä¸å…³å¿ƒæ˜¯ä»€ä¹ˆæ”¯ä»˜æ–¹å¼
    åªè¦æ˜¯ PaymentMethodï¼Œå°±ä¸€å®šæœ‰ pay å’Œ refund æ–¹æ³•
    """
    success = payment_method.pay(amount)
    if success:
        print("æ”¯ä»˜æˆåŠŸ")
    else:
        print("æ”¯ä»˜å¤±è´¥ï¼Œé€€æ¬¾")
        payment_method.refund(amount)

# æµ‹è¯•ï¼šæ‰€æœ‰æ”¯ä»˜æ–¹å¼éƒ½èƒ½ç”¨
å¤„ç†è®¢å•æ”¯ä»˜(AlipayPayment(), 100)     # æ”¯ä»˜å®æ”¯ä»˜ 100 å…ƒ
å¤„ç†è®¢å•æ”¯ä»˜(WechatPayment(), 200)     # å¾®ä¿¡æ”¯ä»˜ 200 å…ƒ
å¤„ç†è®¢å•æ”¯ä»˜(BankCardPayment(), 300)   # é“¶è¡Œå¡æ”¯ä»˜ 300 å…ƒ
```

**å¥½å¤„**ï¼š
- âœ… å¤„ç†è®¢å•çš„ä»£ç ä¸éœ€è¦çŸ¥é“å…·ä½“æ˜¯ä»€ä¹ˆæ”¯ä»˜æ–¹å¼
- âœ… æ·»åŠ æ–°çš„æ”¯ä»˜æ–¹å¼ï¼ˆå¦‚PayPalï¼‰ï¼Œä¸éœ€è¦ä¿®æ”¹å¤„ç†è®¢å•çš„ä»£ç 
- âœ… æ‰€æœ‰æ”¯ä»˜æ–¹å¼æœ‰ç»Ÿä¸€çš„æ¥å£

### 3.3 ä½œç”¨3ï¼šç±»å‹æ£€æŸ¥å’Œæç¤º

```python
from abc import ABC, abstractmethod

class Animal(ABC):
    @abstractmethod
    def make_sound(self):
        pass

class Dog(Animal):
    def make_sound(self):
        print("æ±ªæ±ª")

class Cat(Animal):
    def make_sound(self):
        print("å–µå–µ")

# ç±»å‹æç¤ºï¼šåªæ¥å— Animal ç±»å‹
def let_animal_speak(animal: Animal):
    animal.make_sound()

# IDE ä¼šæç¤ºï¼Œä»£ç æ›´æ¸…æ™°
dog = Dog()
let_animal_speak(dog)  # âœ… IDEçŸ¥é“dogæ˜¯Animalï¼Œæœ‰make_soundæ–¹æ³•
```

---

## 4. ä¸€æ­¥æ­¥å­¦ä¼šä½¿ç”¨ABC

### æ­¥éª¤1ï¼šæœ€ç®€å•çš„æŠ½è±¡ç±»

```python
from abc import ABC, abstractmethod

# å®šä¹‰æŠ½è±¡ç±»
class Shape(ABC):
    @abstractmethod
    def area(self):
        """è®¡ç®—é¢ç§¯ï¼ˆæŠ½è±¡æ–¹æ³•ï¼Œå­ç±»å¿…é¡»å®ç°ï¼‰"""
        pass

# âŒ ä¸èƒ½ç›´æ¥åˆ›å»ºæŠ½è±¡ç±»
# shape = Shape()  # æŠ¥é”™ï¼

# âœ… åˆ›å»ºå­ç±»å¹¶å®ç°æŠ½è±¡æ–¹æ³•
class Circle(Shape):
    def __init__(self, radius):
        self.radius = radius

    def area(self):  # å®ç°æŠ½è±¡æ–¹æ³•
        return 3.14 * self.radius ** 2

# ä½¿ç”¨
circle = Circle(5)
print(f"åœ†çš„é¢ç§¯: {circle.area()}")  # åœ†çš„é¢ç§¯: 78.5
```

### æ­¥éª¤2ï¼šå¤šä¸ªæŠ½è±¡æ–¹æ³•

```python
from abc import ABC, abstractmethod

class Shape(ABC):
    @abstractmethod
    def area(self):
        pass

    @abstractmethod
    def perimeter(self):
        pass

class Rectangle(Shape):
    def __init__(self, width, height):
        self.width = width
        self.height = height

    # å¿…é¡»å®ç°æ‰€æœ‰æŠ½è±¡æ–¹æ³•
    def area(self):
        return self.width * self.height

    def perimeter(self):
        return 2 * (self.width + self.height)

rect = Rectangle(10, 5)
print(f"é¢ç§¯: {rect.area()}, å‘¨é•¿: {rect.perimeter()}")
```

### æ­¥éª¤3ï¼šæŠ½è±¡ç±» + æ™®é€šæ–¹æ³•

```python
from abc import ABC, abstractmethod

class Animal(ABC):
    def __init__(self, name):
        self.name = name

    # æŠ½è±¡æ–¹æ³•ï¼šå­ç±»å¿…é¡»å®ç°
    @abstractmethod
    def make_sound(self):
        pass

    # æ™®é€šæ–¹æ³•ï¼šå­ç±»å¯ä»¥ç›´æ¥ä½¿ç”¨
    def introduce(self):
        print(f"æˆ‘æ˜¯ {self.name}")

class Dog(Animal):
    def make_sound(self):  # å®ç°æŠ½è±¡æ–¹æ³•
        print("æ±ªæ±ª")

class Cat(Animal):
    def make_sound(self):  # å®ç°æŠ½è±¡æ–¹æ³•
        print("å–µå–µ")

# ä½¿ç”¨
dog = Dog("å°é»‘")
dog.introduce()    # æˆ‘æ˜¯ å°é»‘ï¼ˆç»§æ‰¿çš„æ™®é€šæ–¹æ³•ï¼‰
dog.make_sound()   # æ±ªæ±ªï¼ˆè‡ªå·±å®ç°çš„æŠ½è±¡æ–¹æ³•ï¼‰

cat = Cat("å°ç™½")
cat.introduce()    # æˆ‘æ˜¯ å°ç™½
cat.make_sound()   # å–µå–µ
```

### æ­¥éª¤4ï¼šå¸¦å‚æ•°çš„æŠ½è±¡æ–¹æ³•

```python
from abc import ABC, abstractmethod

class DataExporter(ABC):
    @abstractmethod
    def export(self, data, filename):
        """å¯¼å‡ºæ•°æ®åˆ°æ–‡ä»¶"""
        pass

class CSVExporter(DataExporter):
    def export(self, data, filename):
        print(f"å¯¼å‡ºæ•°æ®åˆ° CSV: {filename}")
        # å®é™…çš„CSVå¯¼å‡ºé€»è¾‘
        with open(filename, 'w') as f:
            for row in data:
                f.write(','.join(map(str, row)) + '\n')

class JSONExporter(DataExporter):
    def export(self, data, filename):
        import json
        print(f"å¯¼å‡ºæ•°æ®åˆ° JSON: {filename}")
        with open(filename, 'w') as f:
            json.dump(data, f)

# ä½¿ç”¨
data = [['å§“å', 'å¹´é¾„'], ['å¼ ä¸‰', 25], ['æå››', 30]]

csv = CSVExporter()
csv.export(data, 'data.csv')

json_exp = JSONExporter()
json_exp.export(data, 'data.json')
```

---

## 5. å¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ

### é”™è¯¯1ï¼šå¿˜è®°å®ç°æŠ½è±¡æ–¹æ³•

```python
from abc import ABC, abstractmethod

class Animal(ABC):
    @abstractmethod
    def make_sound(self):
        pass

# âŒ é”™è¯¯ï¼šå¿˜è®°å®ç° make_sound
class Dog(Animal):
    pass  # ä»€ä¹ˆéƒ½æ²¡å†™

# æŠ¥é”™ï¼
dog = Dog()
# TypeError: Can't instantiate abstract class Dog with abstract method make_sound
```

**è§£å†³æ–¹æ¡ˆ**ï¼šå®ç°æ‰€æœ‰æŠ½è±¡æ–¹æ³•

```python
# âœ… æ­£ç¡®
class Dog(Animal):
    def make_sound(self):  # å®ç°äº†æŠ½è±¡æ–¹æ³•
        print("æ±ªæ±ª")

dog = Dog()  # æ­£å¸¸å·¥ä½œ
```

### é”™è¯¯2ï¼šå¿˜è®°ç»§æ‰¿ABC

```python
# âŒ é”™è¯¯ï¼šå¿˜è®°ç»§æ‰¿ABC
class Animal:  # æ²¡æœ‰ç»§æ‰¿ABC
    @abstractmethod
    def make_sound(self):
        pass

# é—®é¢˜ï¼šå¯ä»¥ç›´æ¥åˆ›å»ºå¯¹è±¡ï¼Œæ²¡æœ‰å¼ºåˆ¶è¦æ±‚
animal = Animal()  # å±…ç„¶å¯ä»¥åˆ›å»ºï¼ä½†è°ƒç”¨ä¼šæŠ¥é”™
```

**è§£å†³æ–¹æ¡ˆ**ï¼šç»§æ‰¿ABC

```python
# âœ… æ­£ç¡®
from abc import ABC, abstractmethod

class Animal(ABC):  # ç»§æ‰¿ABC
    @abstractmethod
    def make_sound(self):
        pass

# ç°åœ¨ä¸èƒ½ç›´æ¥åˆ›å»º
# animal = Animal()  # æŠ¥é”™ï¼
```

### é”™è¯¯3ï¼šå¿˜è®°åŠ @abstractmethodè£…é¥°å™¨

```python
from abc import ABC

class Animal(ABC):
    # âŒ å¿˜è®°åŠ  @abstractmethod
    def make_sound(self):
        pass

# é—®é¢˜ï¼šå­ç±»å¯ä»¥ä¸å®ç°è¿™ä¸ªæ–¹æ³•
class Dog(Animal):
    pass  # æ²¡æœ‰å®ç° make_sound

dog = Dog()  # å±…ç„¶å¯ä»¥åˆ›å»ºï¼
```

**è§£å†³æ–¹æ¡ˆ**ï¼šåŠ ä¸Š@abstractmethod

```python
from abc import ABC, abstractmethod

class Animal(ABC):
    @abstractmethod  # âœ… åŠ ä¸Šè£…é¥°å™¨
    def make_sound(self):
        pass

# ç°åœ¨å­ç±»å¿…é¡»å®ç°
class Dog(Animal):
    def make_sound(self):
        print("æ±ªæ±ª")
```

### é”™è¯¯4ï¼šæŠ½è±¡æ–¹æ³•ä¸­å†™äº†å®ç°

```python
from abc import ABC, abstractmethod

class Animal(ABC):
    @abstractmethod
    def make_sound(self):
        print("åŠ¨ç‰©å‘å‡ºå£°éŸ³")  # âŒ æŠ½è±¡æ–¹æ³•ä¸åº”è¯¥æœ‰å®ç°
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- å¦‚æœæ˜¯æ¥å£ï¼Œåªå†™ `pass`
- å¦‚æœéœ€è¦é»˜è®¤å®ç°ï¼Œä¸è¦ç”¨ `@abstractmethod`

```python
# æ–¹æ¡ˆ1ï¼šçº¯æ¥å£
class Animal(ABC):
    @abstractmethod
    def make_sound(self):
        pass  # âœ… åªæ˜¯ä¸€ä¸ªè§„èŒƒ

# æ–¹æ¡ˆ2ï¼šæä¾›é»˜è®¤å®ç°ï¼ˆä¸ç”¨@abstractmethodï¼‰
class Animal(ABC):
    def make_sound(self):  # ä¸åŠ @abstractmethod
        print("åŠ¨ç‰©å‘å‡ºå£°éŸ³")  # è¿™æ˜¯é»˜è®¤å®ç°

class Dog(Animal):
    def make_sound(self):
        print("æ±ªæ±ª")  # å¯ä»¥è¦†ç›–

class Cat(Animal):
    pass  # å¯ä»¥ä¸è¦†ç›–ï¼Œä½¿ç”¨é»˜è®¤å®ç°
```

---

## 6. å®æˆ˜æ¡ˆä¾‹

### æ¡ˆä¾‹1ï¼šäº¤æ˜“ç­–ç•¥ç³»ç»Ÿï¼ˆNOFXé£æ ¼ï¼‰

```python
from abc import ABC, abstractmethod

# å®šä¹‰ç­–ç•¥æ¥å£
class TradingStrategy(ABC):
    """äº¤æ˜“ç­–ç•¥æ¥å£"""

    @abstractmethod
    def should_buy(self, price_data):
        """æ˜¯å¦åº”è¯¥ä¹°å…¥"""
        pass

    @abstractmethod
    def should_sell(self, price_data):
        """æ˜¯å¦åº”è¯¥å–å‡º"""
        pass

    @abstractmethod
    def get_name(self):
        """è·å–ç­–ç•¥åç§°"""
        pass

# å®ç°ï¼šç§»åŠ¨å¹³å‡ç­–ç•¥
class MovingAverageStrategy(TradingStrategy):
    def __init__(self, short_period=10, long_period=20):
        self.short_period = short_period
        self.long_period = long_period

    def should_buy(self, price_data):
        # çŸ­æœŸå‡çº¿ä¸Šç©¿é•¿æœŸå‡çº¿ï¼Œä¹°å…¥ä¿¡å·
        short_ma = self._calculate_ma(price_data, self.short_period)
        long_ma = self._calculate_ma(price_data, self.long_period)
        return short_ma > long_ma

    def should_sell(self, price_data):
        # çŸ­æœŸå‡çº¿ä¸‹ç©¿é•¿æœŸå‡çº¿ï¼Œå–å‡ºä¿¡å·
        short_ma = self._calculate_ma(price_data, self.short_period)
        long_ma = self._calculate_ma(price_data, self.long_period)
        return short_ma < long_ma

    def get_name(self):
        return f"MA({self.short_period},{self.long_period})"

    def _calculate_ma(self, data, period):
        """è®¡ç®—ç§»åŠ¨å¹³å‡"""
        return sum(data[-period:]) / period

# å®ç°ï¼šRSIç­–ç•¥
class RSIStrategy(TradingStrategy):
    def __init__(self, period=14, overbought=70, oversold=30):
        self.period = period
        self.overbought = overbought
        self.oversold = oversold

    def should_buy(self, price_data):
        rsi = self._calculate_rsi(price_data)
        return rsi < self.oversold  # RSIä½äº30ï¼Œè¶…å–ï¼Œä¹°å…¥

    def should_sell(self, price_data):
        rsi = self._calculate_rsi(price_data)
        return rsi > self.overbought  # RSIé«˜äº70ï¼Œè¶…ä¹°ï¼Œå–å‡º

    def get_name(self):
        return f"RSI({self.period})"

    def _calculate_rsi(self, data):
        """è®¡ç®—RSIï¼ˆç®€åŒ–ç‰ˆï¼‰"""
        gains = []
        losses = []
        for i in range(1, len(data)):
            change = data[i] - data[i-1]
            if change > 0:
                gains.append(change)
            else:
                losses.append(abs(change))

        avg_gain = sum(gains) / len(gains) if gains else 0
        avg_loss = sum(losses) / len(losses) if losses else 0

        if avg_loss == 0:
            return 100

        rs = avg_gain / avg_loss
        rsi = 100 - (100 / (1 + rs))
        return rsi

# äº¤æ˜“å¼•æ“ï¼ˆä¸å…³å¿ƒå…·ä½“ç­–ç•¥ï¼‰
class TradingEngine:
    def __init__(self, strategy: TradingStrategy):
        self.strategy = strategy

    def run(self, price_data):
        print(f"ä½¿ç”¨ç­–ç•¥: {self.strategy.get_name()}")

        if self.strategy.should_buy(price_data):
            print("âœ… ä¹°å…¥ä¿¡å·")
        elif self.strategy.should_sell(price_data):
            print("âŒ å–å‡ºä¿¡å·")
        else:
            print("â¸ï¸  æŒæœ‰")

# ä½¿ç”¨ï¼šå¯ä»¥éšæ„åˆ‡æ¢ç­–ç•¥
price_data = [100, 102, 101, 103, 105, 104, 106, 108, 107, 109, 111, 110, 112]

# ä½¿ç”¨ç§»åŠ¨å¹³å‡ç­–ç•¥
ma_strategy = MovingAverageStrategy(short_period=3, long_period=5)
engine = TradingEngine(ma_strategy)
engine.run(price_data)

print()

# åˆ‡æ¢åˆ°RSIç­–ç•¥
rsi_strategy = RSIStrategy(period=14)
engine = TradingEngine(rsi_strategy)
engine.run(price_data)
```

**è¾“å‡º**ï¼š
```
ä½¿ç”¨ç­–ç•¥: MA(3,5)
âœ… ä¹°å…¥ä¿¡å·

ä½¿ç”¨ç­–ç•¥: RSI(14)
â¸ï¸  æŒæœ‰
```

**å…³é”®ç‚¹**ï¼š
- `TradingEngine` åªä¾èµ– `TradingStrategy` æ¥å£
- å¯ä»¥æ·»åŠ æ–°ç­–ç•¥ï¼ˆå¦‚MACDã€å¸ƒæ—å¸¦ï¼‰ï¼Œä¸éœ€è¦ä¿®æ”¹å¼•æ“ä»£ç 
- æ‰€æœ‰ç­–ç•¥éƒ½ä¿è¯æœ‰ `should_buy`ã€`should_sell`ã€`get_name` æ–¹æ³•

### æ¡ˆä¾‹2ï¼šæ•°æ®åº“è®¿é—®å±‚

```python
from abc import ABC, abstractmethod

# å®šä¹‰æ•°æ®åº“æ¥å£
class Database(ABC):
    @abstractmethod
    def connect(self):
        """è¿æ¥æ•°æ®åº“"""
        pass

    @abstractmethod
    def disconnect(self):
        """æ–­å¼€è¿æ¥"""
        pass

    @abstractmethod
    def query(self, sql):
        """æ‰§è¡ŒæŸ¥è¯¢"""
        pass

    @abstractmethod
    def execute(self, sql):
        """æ‰§è¡Œæ›´æ–°/æ’å…¥/åˆ é™¤"""
        pass

# å®ç°ï¼šMySQL
class MySQLDatabase(Database):
    def connect(self):
        print("è¿æ¥åˆ°MySQL")

    def disconnect(self):
        print("æ–­å¼€MySQLè¿æ¥")

    def query(self, sql):
        print(f"MySQLæŸ¥è¯¢: {sql}")
        return []  # æ¨¡æ‹Ÿè¿”å›ç»“æœ

    def execute(self, sql):
        print(f"MySQLæ‰§è¡Œ: {sql}")
        return True

# å®ç°ï¼šPostgreSQL
class PostgreSQLDatabase(Database):
    def connect(self):
        print("è¿æ¥åˆ°PostgreSQL")

    def disconnect(self):
        print("æ–­å¼€PostgreSQLè¿æ¥")

    def query(self, sql):
        print(f"PostgreSQLæŸ¥è¯¢: {sql}")
        return []

    def execute(self, sql):
        print(f"PostgreSQLæ‰§è¡Œ: {sql}")
        return True

# å®ç°ï¼šMongoDB
class MongoDatabase(Database):
    def connect(self):
        print("è¿æ¥åˆ°MongoDB")

    def disconnect(self):
        print("æ–­å¼€MongoDBè¿æ¥")

    def query(self, sql):
        # MongoDBç”¨çš„ä¸æ˜¯SQLï¼Œè¿™é‡Œè½¬æ¢ä¸€ä¸‹
        print(f"MongoDBæŸ¥è¯¢: {sql}")
        return []

    def execute(self, sql):
        print(f"MongoDBæ‰§è¡Œ: {sql}")
        return True

# ç”¨æˆ·æœåŠ¡ï¼ˆä¸å…³å¿ƒå…·ä½“æ•°æ®åº“ï¼‰
class UserService:
    def __init__(self, db: Database):
        self.db = db

    def get_user(self, user_id):
        self.db.connect()
        results = self.db.query(f"SELECT * FROM users WHERE id={user_id}")
        self.db.disconnect()
        return results

    def create_user(self, name, email):
        self.db.connect()
        self.db.execute(f"INSERT INTO users (name, email) VALUES ('{name}', '{email}')")
        self.db.disconnect()

# ä½¿ç”¨ï¼šå¯ä»¥éšæ„åˆ‡æ¢æ•°æ®åº“
print("=== ä½¿ç”¨MySQL ===")
mysql = MySQLDatabase()
service = UserService(mysql)
service.get_user(123)

print("\n=== åˆ‡æ¢åˆ°PostgreSQL ===")
postgres = PostgreSQLDatabase()
service = UserService(postgres)
service.create_user("å¼ ä¸‰", "zhang@example.com")

print("\n=== åˆ‡æ¢åˆ°MongoDB ===")
mongo = MongoDatabase()
service = UserService(mongo)
service.get_user(456)
```

**è¾“å‡º**ï¼š
```
=== ä½¿ç”¨MySQL ===
è¿æ¥åˆ°MySQL
MySQLæŸ¥è¯¢: SELECT * FROM users WHERE id=123
æ–­å¼€MySQLè¿æ¥

=== åˆ‡æ¢åˆ°PostgreSQL ===
è¿æ¥åˆ°PostgreSQL
PostgreSQLæ‰§è¡Œ: INSERT INTO users (name, email) VALUES ('å¼ ä¸‰', 'zhang@example.com')
æ–­å¼€PostgreSQLè¿æ¥

=== åˆ‡æ¢åˆ°MongoDB ===
è¿æ¥åˆ°MongoDB
MongoDBæŸ¥è¯¢: SELECT * FROM users WHERE id=456
æ–­å¼€MongoDBè¿æ¥
```

---

## 7. æ€»ç»“å’Œæœ€ä½³å®è·µ

### 7.1 ä»€ä¹ˆæ—¶å€™ç”¨æŠ½è±¡åŸºç±»ï¼Ÿ

âœ… **åº”è¯¥ä½¿ç”¨ABCçš„åœºæ™¯**ï¼š

1. **å®šä¹‰æ¥å£/è§„èŒƒ**
   ```python
   # æ‰€æœ‰æ”¯ä»˜æ–¹å¼å¿…é¡»æœ‰ pay å’Œ refund æ–¹æ³•
   class PaymentMethod(ABC):
       @abstractmethod
       def pay(self, amount): pass
       @abstractmethod
       def refund(self, amount): pass
   ```

2. **å¼ºåˆ¶å­ç±»å®ç°æŸäº›æ–¹æ³•**
   ```python
   # æ‰€æœ‰ç­–ç•¥å¿…é¡»æœ‰ execute æ–¹æ³•
   class Strategy(ABC):
       @abstractmethod
       def execute(self, data): pass
   ```

3. **å¤šä¸ªç±»æœ‰ç›¸åŒæ¥å£ï¼Œä½†å®ç°ä¸åŒ**
   ```python
   # Circleã€Rectangleã€Triangle éƒ½æœ‰ area æ–¹æ³•ï¼Œä½†è®¡ç®—æ–¹å¼ä¸åŒ
   class Shape(ABC):
       @abstractmethod
       def area(self): pass
   ```

âŒ **ä¸éœ€è¦ä½¿ç”¨ABCçš„åœºæ™¯**ï¼š

1. **åªæœ‰ä¸€ä¸ªå®ç°**
   ```python
   # å¦‚æœåªæœ‰ä¸€ç§æ”¯ä»˜æ–¹å¼ï¼Œä¸éœ€è¦ABC
   class AlipayPayment:
       def pay(self, amount): ...
   ```

2. **ä¸éœ€è¦å¼ºåˆ¶è§„èŒƒ**
   ```python
   # å¦‚æœå­ç±»å¯ä»¥é€‰æ‹©æ€§å®ç°æ–¹æ³•ï¼Œä¸éœ€è¦ABC
   class BaseModel:
       def save(self): ...
       def delete(self): ...
   ```

### 7.2 æœ€ä½³å®è·µ

**1. æ¥å£åº”è¯¥ç®€æ´**

```python
# âœ… å¥½ï¼šæ¥å£ç®€æ´
class Drawable(ABC):
    @abstractmethod
    def draw(self): pass

# âŒ ä¸å¥½ï¼šæ¥å£å¤ªå¤æ‚
class Drawable(ABC):
    @abstractmethod
    def draw(self): pass
    @abstractmethod
    def resize(self): pass
    @abstractmethod
    def rotate(self): pass
    @abstractmethod
    def change_color(self): pass
    # ... 20ä¸ªæ–¹æ³•
```

**2. å‘½åæ¸…æ™°**

```python
# âœ… å¥½ï¼šæ¸…æ™°çš„å‘½å
class PaymentProcessor(ABC): ...
class DataExporter(ABC): ...
class TradingStrategy(ABC): ...

# âŒ ä¸å¥½ï¼šæ¨¡ç³Šçš„å‘½å
class Handler(ABC): ...
class Manager(ABC): ...
class Service(ABC): ...
```

**3. æä¾›æ–‡æ¡£å­—ç¬¦ä¸²**

```python
# âœ… å¥½ï¼šæœ‰æ–‡æ¡£è¯´æ˜
class DataExporter(ABC):
    @abstractmethod
    def export(self, data, filename):
        """
        å¯¼å‡ºæ•°æ®åˆ°æ–‡ä»¶

        Args:
            data: è¦å¯¼å‡ºçš„æ•°æ®
            filename: ç›®æ ‡æ–‡ä»¶å

        Returns:
            bool: æ˜¯å¦æˆåŠŸ
        """
        pass
```

**4. åªç”¨äºå®šä¹‰æ¥å£ï¼Œä¸è¦æœ‰å¤æ‚é€»è¾‘**

```python
# âœ… å¥½ï¼šåªå®šä¹‰æ¥å£
class Animal(ABC):
    @abstractmethod
    def make_sound(self):
        pass

# âŒ ä¸å¥½ï¼šæŠ½è±¡ç±»é‡Œæœ‰å¤æ‚é€»è¾‘
class Animal(ABC):
    @abstractmethod
    def make_sound(self):
        # å¤§é‡ä»£ç ...
        print("doing complex stuff")
        # ...
```

### 7.3 æ ¸å¿ƒè¦ç‚¹æ€»ç»“

1. **ABC = è§„èŒƒ/å¥‘çº¦**
   - å®šä¹‰"å¿…é¡»åšä»€ä¹ˆ"
   - ä¸å…³å¿ƒ"æ€ä¹ˆåš"

2. **@abstractmethod = å¼ºåˆ¶å®ç°**
   - å­ç±»å¿…é¡»å®ç°æŠ½è±¡æ–¹æ³•
   - å¦åˆ™æ— æ³•åˆ›å»ºå¯¹è±¡

3. **ç»Ÿä¸€æ¥å£ = çµæ´»æ€§**
   - å¯ä»¥éšæ„æ›¿æ¢å®ç°
   - ä¸éœ€è¦ä¿®æ”¹è°ƒç”¨ä»£ç 

4. **ç±»å‹æç¤º = æ¸…æ™°æ€§**
   - ä»£ç æ›´æ¸…æ™°
   - IDE æ›´æ™ºèƒ½

### 7.4 è®°å¿†å£è¯€

```
æ¥å£åƒè§„èŒƒï¼Œå®šä¹‰å¿…é¡»åšä»€ä¹ˆ
æŠ½è±¡æ–¹æ³•å¼ºåˆ¶å®ç°ï¼Œå¿˜äº†å°±æŠ¥é”™
ç»§æ‰¿ABCå®šæ¥å£ï¼Œå­ç±»å®ç°æ‰èƒ½ç”¨
ç»Ÿä¸€è§„èŒƒæ˜“æ‰©å±•ï¼Œä»£ç æ¸…æ™°æ˜“ç»´æŠ¤
```

---

## ğŸ¯ ç»ƒä¹ é¢˜

### ç»ƒä¹ 1ï¼šç®€å•çš„æ¥å£

å®šä¹‰ä¸€ä¸ª `Logger` æ¥å£ï¼Œè¦æ±‚ï¼š
- æœ‰ `log(message)` æ–¹æ³•
- å®ç°ä¸¤ä¸ªå­ç±»ï¼š`FileLogger`ï¼ˆå†™æ–‡ä»¶ï¼‰ã€`ConsoleLogger`ï¼ˆæ‰“å°åˆ°æ§åˆ¶å°ï¼‰

### ç»ƒä¹ 2ï¼šæ”¯ä»˜ç³»ç»Ÿ

è®¾è®¡ä¸€ä¸ªæ”¯ä»˜ç³»ç»Ÿï¼Œè¦æ±‚ï¼š
- å®šä¹‰ `PaymentGateway` æ¥å£
- å®ç°ä¸‰ç§æ”¯ä»˜ï¼šæ”¯ä»˜å®ã€å¾®ä¿¡ã€é“¶è¡Œå¡
- æ‰€æœ‰æ”¯ä»˜æ–¹å¼éƒ½è¦æœ‰ï¼š`pay(amount)`ã€`refund(amount)`ã€`get_balance()` æ–¹æ³•

### ç»ƒä¹ 3ï¼šæ•°æ®éªŒè¯å™¨

åˆ›å»ºä¸€ä¸ªéªŒè¯å™¨æ¥å£ï¼Œè¦æ±‚ï¼š
- å®šä¹‰ `Validator` æ¥å£ï¼Œæœ‰ `validate(data)` æ–¹æ³•
- å®ç°ï¼š`EmailValidator`ã€`PhoneValidator`ã€`IDCardValidator`
- åˆ›å»ºä¸€ä¸ª `FormValidator` ç±»ï¼Œå¯ä»¥æ·»åŠ å¤šä¸ªéªŒè¯å™¨

---

**ğŸ“ ç°åœ¨ä½ åº”è¯¥å®Œå…¨ç†è§£æ¥å£å’ŒæŠ½è±¡åŸºç±»äº†ï¼**

è®°ä½ï¼š**æ¥å£å°±æ˜¯è§„èŒƒï¼ŒæŠ½è±¡åŸºç±»å°±æ˜¯å¼ºåˆ¶æ‰§è¡Œè¿™ä¸ªè§„èŒƒçš„å·¥å…·**ã€‚

**ä¸‹ä¸€æ­¥**ï¼šå›åˆ°[ç¬¬3ç« ä¸»æ–‡æ¡£](chapter03-module-design.md)ï¼Œç»§ç»­å­¦ä¹ æ¨¡å—è®¾è®¡ï¼
